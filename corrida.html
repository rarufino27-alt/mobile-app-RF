<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Corrida em andamento</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --rf-gold:#D6B85F;
  --rf-gold-strong:#F0D98A;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;}

body{
  background: radial-gradient(circle at top,#1A2133 0%,#080A12 70%);
  color:#fff;
  overflow:hidden;
  animation:fadeIn .4s ease;
}

@keyframes fadeIn{
  from{opacity:0;transform:scale(1.02);}
  to{opacity:1;transform:scale(1);}
}

.header{
  padding:20px;
  font-weight:700;
  font-size:16px;
}

.status{
  text-align:center;
  margin-top:10px;
  font-size:16px;
  color:var(--rf-gold-strong);
}

/* MAPA SIMULADO */
.map-area{
  margin:20px;
  height:350px;
  border-radius:25px;
  background:linear-gradient(145deg,#111522,#0E1422);
  border:1px solid rgba(214,184,95,.2);
  position:relative;
  overflow:hidden;
}

/* Simulação de rota */
.rota{
  position:absolute;
  width:4px;
  height:200px;
  background:var(--rf-gold);
  left:50%;
  top:70px;
  transform:translateX(-50%);
  border-radius:10px;
}

/* Motorista */
.motorista-dot{
  position:absolute;
  width:14px;
  height:14px;
  border-radius:50%;
  background:var(--rf-gold-strong);
  left:50%;
  transform:translateX(-50%);
  top:60px;
  transition:top 2s linear;
}

/* Card inferior */
.card{
  position:fixed;
  bottom:0;
  width:100%;
  background:#151B2B;
  border-top-left-radius:30px;
  border-top-right-radius:30px;
  padding:25px;
  box-shadow:0 -20px 50px rgba(0,0,0,.8);
}

.card-info{
  font-size:14px;
  line-height:1.6;
}

.card-info strong{
  color:var(--rf-gold-strong);
}

button{
  margin-top:20px;
  padding:16px;
  width:100%;
  border:none;
  border-radius:40px;
  background:linear-gradient(135deg,var(--rf-gold),var(--rf-gold-strong));
  font-weight:700;
}
</style>
</head>

<body>

<div class="header">Corrida em andamento</div>
<div class="status" id="statusText">Motorista a caminho...</div>

<div class="map-area">
  <div class="rota"></div>
  <div class="motorista-dot" id="motoristaDot"></div>
</div>

<div class="card">
  <div class="card-info" id="infoCorrida"></div>
  <button id="acaoBtn">Aguardando motorista...</button>
</div>

<script>

const corrida = JSON.parse(localStorage.getItem("rf_corrida_temp"));
if(!corrida) window.location.href="home.html";

let status = "a_caminho";
let inicio = Date.now();

document.getElementById("infoCorrida").innerHTML = `
<strong>Origem:</strong> ${corrida.origem}<br>
${corrida.parada?`<strong>Parada:</strong> ${corrida.parada}<br>`:""}
<strong>Destino:</strong> ${corrida.destino}<br>
<strong>Valor acordado:</strong> R$ ${corrida.valorFinal || corrida.total}
`;

const motoristaDot = document.getElementById("motoristaDot");
const statusText = document.getElementById("statusText");
const botao = document.getElementById("acaoBtn");

/* ===== SIMULAÇÃO DE STATUS ===== */

setTimeout(()=>{
  status = "chegou";
  motoristaDot.style.top="220px";
  statusText.innerText="Motorista chegou ao local";
  botao.innerText="Iniciar percurso";
},5000);

botao.onclick = ()=>{

  if(status==="chegou"){
    status="em_percurso";
    statusText.innerText="Percurso em andamento...";
    botao.innerText="Finalizar corrida";
    motoristaDot.style.top="80px";
  }
  else if(status==="em_percurso"){
    finalizarCorrida();
  }

};

function finalizarCorrida(){

  const fim = Date.now();
  const duracaoMin = Math.round((fim - inicio)/60000);

  corrida.tempoViagem = duracaoMin;
  localStorage.setItem("rf_corrida_temp", JSON.stringify(corrida));

  window.location.href="finalizacao.html";
}

</script>

</body>
</html>