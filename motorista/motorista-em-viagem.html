<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>RF Driver - Em Viagem</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
}

body{
  background:#000;
  color:#fff;
  height:100vh;
  display:flex;
  flex-direction:column;
}

/* HEADER */
.header{
  height:70px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  font-size:1.1rem;
  border-bottom:1px solid #222;
}

/* MAPA */
.mapa{
  height:40%;
  background:linear-gradient(#1a1a1a,#000);
  display:flex;
  align-items:center;
  justify-content:center;
  color:#facc15;
  font-weight:700;
}

/* CONTEÃšDO */
.content{
  flex:1;
  background:#111;
  padding:25px;
  border-top-left-radius:25px;
  border-top-right-radius:25px;
}

.status{
  font-size:.9rem;
  color:#aaa;
  margin-bottom:15px;
}

.valor{
  font-size:1.8rem;
  font-weight:900;
  margin-bottom:20px;
}

.rota div{
  margin-bottom:10px;
  font-size:1rem;
}

.cronometro{
  margin-top:15px;
  color:#888;
  font-size:.9rem;
}

.btn{
  width:100%;
  padding:15px;
  margin-top:20px;
  border:none;
  border-radius:30px;
  background:#facc15;
  color:#000;
  font-weight:900;
  font-size:1rem;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="header">
  ðŸš˜ Em viagem
</div>

<div class="mapa">
  Indo para o destino...
</div>

<div class="content">

  <div class="status">
    Passageiro a bordo
  </div>

  <div class="valor">
    R$ <span id="valorCorrida">0</span>
  </div>

  <div class="rota">
    <div><strong>Destino:</strong> <span id="destinoCorrida"></span></div>
  </div>

  <div class="cronometro">
    Tempo de viagem: <span id="tempo">00:00</span>
  </div>

  <button class="btn" onclick="finalizarCorrida()">
    FINALIZAR VIAGEM
  </button>

</div>

<script>

// ================= CARREGAR CORRIDA =================

const corrida = JSON.parse(localStorage.getItem("rf_corrida_aceita"));

if(!corrida){
  alert("Nenhuma corrida ativa.");
  window.location.href = "driver-home.html";
}

document.getElementById("valorCorrida").innerText = corrida.valor;
document.getElementById("destinoCorrida").innerText = corrida.destino;

// ================= CRONÃ”METRO =================

let segundos = 0;

function atualizarCronometro(){
  segundos++;

  const min = String(Math.floor(segundos / 60)).padStart(2,'0');
  const seg = String(segundos % 60).padStart(2,'0');

  document.getElementById("tempo").innerText = `${min}:${seg}`;
}

setInterval(atualizarCronometro, 1000);

// ================= FINALIZAR =================

function finalizarCorrida(){

  const valor = Number(corrida.valor);

  // Atualizar ganho do dia
  let ganhoDia = Number(localStorage.getItem("rf_driver_ganho_dia")) || 0;
  ganhoDia += valor;
  localStorage.setItem("rf_driver_ganho_dia", ganhoDia);

  // Salvar histÃ³rico
  let historico = JSON.parse(localStorage.getItem("rf_historico_corridas")) || [];
  
  historico.push({
    origem: corrida.origem,
    destino: corrida.destino,
    valor: valor,
    data: new Date().toLocaleString()
  });

  localStorage.setItem("rf_historico_corridas", JSON.stringify(historico));

  // Limpar estado atual
  localStorage.removeItem("rf_corrida_aceita");
  localStorage.removeItem("rf_status_corrida");

  alert("Corrida finalizada com sucesso ðŸš€");

  window.location.href = "driver-home.html";
}

</script>

</body>
</html>
